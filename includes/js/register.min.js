function rcp_validate_form(e){rcp_validate_subscription_level(),e&&rcp_validate_gateways()}function rcp_validate_subscription_level(){if(!rcp_validating_level){var e=jQuery,r=!1,a=jQuery("#rcp_subscription_levels input:checked"),_=e(".rcp_gateway_fields").hasClass("rcp_discounted_100");rcp_validating_level=!0,0==a.attr("rel")&&(r=!0),r?(e(".rcp_gateway_fields,#rcp_auto_renew_wrap,#rcp_discount_code_wrap").hide(),e(".rcp_gateway_fields").removeClass("rcp_discounted_100"),e("#rcp_discount_code_wrap input").val(""),e(".rcp_discount_amount,#rcp_gateway_extra_fields").remove(),e(".rcp_discount_valid, .rcp_discount_invalid").hide(),e("#rcp_auto_renew_wrap input").attr("checked",!1)):(_?e("#rcp_gateway_extra_fields").remove():e(".rcp_gateway_fields,#rcp_auto_renew_wrap").show(),e("#rcp_discount_code_wrap").show()),rcp_validating_level=!1}}function rcp_validate_gateways(){if(!rcp_validating_gateway){var e,r=jQuery,a=r("#rcp_registration_form"),_=!1,c=jQuery("#rcp_subscription_levels input:checked"),t=r(".rcp_gateway_fields").hasClass("rcp_discounted_100");if(rcp_validating_gateway=!0,0==c.attr("rel")&&(_=!0),r(".rcp_message.error",a).remove(),r("#rcp_payment_gateways").length>0?(e=r("#rcp_payment_gateways select option:selected"),e.length<1&&(e=r('input[name="rcp_gateway"]:checked'))):e=r('input[name="rcp_gateway"]'),_)r(".rcp_gateway_fields").hide(),r("#rcp_auto_renew_wrap").hide(),r("#rcp_auto_renew_wrap input").attr("checked",!1),r("#rcp_gateway_extra_fields").remove();else{if(t)r("#rcp_gateway_extra_fields").remove();else{r(".rcp_gateway_fields").show();var i={action:"rcp_load_gateway_fields",rcp_gateway:e.val()};r.post(rcp_script_options.ajaxurl,i,function(a){r("#rcp_gateway_extra_fields").remove(),a.success&&a.data.fields&&r('<div class="rcp_gateway_'+e.val()+'_fields" id="rcp_gateway_extra_fields">'+a.data.fields+"</div>").insertAfter(r(".rcp_gateway_fields").length?".rcp_gateway_fields":".rcp_gateways_fieldset")})}"yes"!=e.data("supports-recurring")||t?(r("#rcp_auto_renew_wrap").hide(),r("#rcp_auto_renew_wrap input").attr("checked",!1)):r("#rcp_auto_renew_wrap").show(),r("#rcp_discount_code_wrap").show()}rcp_validating_gateway=!1}}function rcp_validate_discount(e){if(!rcp_validating_discount){var r=jQuery,a=r(".rcp_gateway_fields"),_={action:"validate_discount",code:e,subscription_id:r("#rcp_subscription_levels input:checked").val()};rcp_validating_discount=!0,r.post(rcp_script_options.ajaxurl,_,function(e){r(".rcp_discount_amount").remove(),r(".rcp_discount_valid, .rcp_discount_invalid").hide(),e.valid?e.valid&&(r(".rcp_discount_valid").show(),r("#rcp_discount_code_wrap label").append('<span class="rcp_discount_amount"> - '+e.amount+"</span>"),e.full?(r("#rcp_auto_renew_wrap").hide(),a.hide().addClass("rcp_discounted_100"),r("#rcp_gateway_extra_fields").remove()):(r("#rcp_auto_renew_wrap").show(),a.show().removeClass("rcp_discounted_100"))):(r(".rcp_discount_invalid").show(),a.removeClass("rcp_discounted_100"),r(".rcp_gateway_fields,#rcp_auto_renew_wrap").show()),rcp_validating_discount=!1,r("body").trigger("rcp_discount_applied",[e])})}}var rcp_validating_discount=!1,rcp_validating_gateway=!1,rcp_validating_level=!1,rcp_processing=!1;jQuery(document).ready(function(e){rcp_validate_form(!0),e("#rcp_payment_gateways select, #rcp_payment_gateways input").change(function(){e("body").trigger("rcp_gateway_change")}),e(".rcp_level").change(function(){e("body").trigger("rcp_level_change")}),e("body").on("rcp_gateway_change",function(){rcp_validate_form(!0)}).on("rcp_level_change",function(){rcp_validate_form(!0)}).on("rcp_discount_applied",function(){rcp_validate_form(!0)}),e("#rcp_discount_code").keyup(function(r){13!=r.which&&rcp_validate_discount(e(this).val())}),e(document).on("click","#rcp_registration_form #rcp_submit",function(r){var a=document.getElementById("rcp_registration_form"),_=e("#rcp_registration_form");if("function"!=typeof a.checkValidity||!1!==a.checkValidity()){r.preventDefault();var c=e(this).val();_.block({message:rcp_script_options.pleasewait,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}}),e("#rcp_submit",_).val(rcp_script_options.pleasewait),rcp_processing||(rcp_processing=!0,e.post(rcp_script_options.ajaxurl,_.serialize()+"&action=rcp_process_register_form&rcp_ajax=true",function(r){e(".rcp-submit-ajax",_).remove(),e(".rcp_message.error",_).remove(),r.success?(e("body").trigger("rcp_register_form_submission"),e(a).submit()):(e("#rcp_submit",_).val(c),e("#rcp_submit",_).before(r.data.errors),e("#rcp_register_nonce",_).val(r.data.nonce),_.unblock())}).done(function(){}).fail(function(e){console.log(e)}).always(function(){}))}})});